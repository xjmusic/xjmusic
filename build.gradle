// Copyright (c) XJ Music Inc. (https://xj.io) All Rights Reserved.

plugins {
  id 'java'
  id 'application'
  id 'distribution'
  //
  id 'de.undercouch.download' version "4.0.4"
  id 'org.ajoberstar.grgit' version '4.1.0'
  //
  id "org.flywaydb.flyway" version "9.16.1" apply false
  id 'com.google.cloud.tools.jib' version '3.3.2' apply false
  id 'io.spring.dependency-management' version '1.0.15.RELEASE' apply false
  id 'nu.studer.jooq' version '6.0.1' apply false
  id 'org.springframework.boot' version '2.7.6' apply false
}

ext {
  googleApiClientVersion = '2.2.0'
  googleApiServicePlusVersion = 'v1-rev590-1.25.0'
  guavaVersion = '31.1-jre'
  jacksonAnnotationsVersion = '2.15.2'
  springBootVersion = '2.7.6'
  springTestVersion = '5.3.24'
}

allprojects {
  group = 'io.xj'

  tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
  }
}

subprojects {
  apply plugin: 'java'

  repositories {
    mavenLocal()
    maven {
      name = 'ajoberstar-backup'
      url = 'https://ajoberstar.org/bintray-backup/'
    }
    maven {
      url = 'https://repo.maven.apache.org/maven2'
    }
    maven {
      url = 'https://packages.confluent.io/maven/'
    }
    maven {
      url = 'https://oss.sonatype.org/content/repositories/releases'
    }
  }

  java {
    sourceCompatibility = JavaVersion.VERSION_17
    targetCompatibility = JavaVersion.VERSION_17
  }
}

if (!project.hasProperty("jibFromImage")) {
  ext.jibFromImage = "localhost/base:latest"
}

if (!project.hasProperty("jibToImageRegistry")) {
  ext.jibToImageRegistry = "localhost"
}
